<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <record id="mrp_bom_form_view_evaluation" model="ir.ui.view">
        <field name="name">mrp.bom.evaluation.form</field>
        <field name="model">mrp.bom.evaluation</field>
        <field name="arch" type="xml">
            <form string="Bill of Material">
                <sheet>
                    <div class="oe_button_box" name="button_box">
                        <button name="%(action_report_bom_evaluation)d" type="action"
                            class="oe_stat_button" icon="fa-bars" string="Structure &amp; Cost" attrs="{'invisible': [('bom_evaluation_line_ids', '=', [])]}"/>
                        <button name="toggle_active" type="object"
                                class="oe_stat_button" icon="fa-archive">
                            <field name="active" widget="boolean_button"
                                options='{"terminology": "archive"}'/>
                        </button>
                    </div>
                <group>
                    <group>
                        <field name="product_tmpl_id" context="{'default_type': 'product'}"/>
                        <field name="product_id" groups="product.group_product_variant" context="{'default_type': 'product'}"/>
                        <label for="product_qty" string="Quantity"/>
                        <div class="o_row">
                            <field name="product_qty"/>
                            <field name="product_uom_id" options="{'no_open':True,'no_create':True}" groups="uom.group_uom"/>
                        </div>
                        <field name="routing_id" groups="mrp.group_mrp_routings"/>
                    </group>
                    <group>
                        <field name="code"/>
                        <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
                    </group>
                </group>
                <notebook>
                    <page string="Components">
                        <field name="bom_evaluation_line_ids" widget="one2many_list" context="{'default_parent_product_tmpl_id': product_tmpl_id}">
                            <tree string="Components" editable="bottom">
                                <field name="sequence" widget="handle"/>
                                <field name="product_id" context="{'default_type': 'product'}"/>
                                <field name="product_qty"/>
                                <field name="parent_product_tmpl_id" invisible="1" />
                                <field name="product_uom_id" options="{'no_open':True,'no_create':True}" groups="uom.group_uom"/>
                                <field name="price_unit"/>
                                <field name="note"/>
                                <field name="price_write_date"/>
                                <field name="price_validated"/>
                                <field name="price_subtotal" sum="Total"/>
                            </tree>
                        </field>
                        <field name="bom_operation_ids" widget="one2many_list">
                            <tree string="Estimated Operations" editable="bottom">
                                <field name="operation_id"/>
                                <field name="name"/>
                                <field name="time" widget="float_time"/>
                                <field name="price_unit"/>
                                <field name="price_subtotal" sum="Total"/>
                            </tree>
                        </field>
                        <div class="oe_clear"/>
                        <group class="oe_subtotal_footer oe_right">
                            <field name="total_amount" class="oe_subtotal_footer_separator"/>
                        </group>
                    </page>
                </notebook>
                </sheet>
                <div class="oe_chatter">
                     <field name="message_follower_ids" widget="mail_followers"/>
                     <field name="message_ids" colspan="4" widget="mail_thread" nolabel="1"/>
                </div>
            </form>
        </field>
    </record>
    <record id="mrp_bom_tree_view_evaluation" model="ir.ui.view">
        <field name="name">mrp.bom.evaluation.tree</field>
        <field name="model">mrp.bom.evaluation</field>
        <field name="arch" type="xml">
            <tree string="Bill of Materials" default_order="product_tmpl_id">
                <field name="active" invisible="1"/>
                <field name="sequence" invisible="1"/>
                <field name="product_tmpl_id"/>
                <field name="code"/>
                <field name="product_id" groups="product.group_product_variant"/>
                <field name="product_qty"/>
                <field name="product_uom_id" groups="uom.group_uom"/>
                <field name="routing_id" groups="mrp.group_mrp_routings"/>
            </tree>
        </field>
    </record>
    <record id="mrp_bom_form_evaluation_action" model="ir.actions.act_window">
        <field name="name">Bills of Materials for Evaluation</field>
        <field name="type">ir.actions.act_window</field>
        <field name="res_model">mrp.bom.evaluation</field>
        <field name="view_type">form</field>
        <field name="view_mode">tree,form</field>
        <field name="help" type="html">
          <p class="o_view_nocontent_smiling_face">
            Create a bill of materials for evaluation
          </p><p>
            These bills of materials allow you to define the list of required raw
            materials and operation used to make a finished product to evaluate its cost.
          </p>
        </field>
    </record>
    <menuitem id="menu_mrp_bom_form_evaluation_action"
        action="mrp_bom_form_evaluation_action"
        parent="mrp.menu_mrp_bom"
        groups="account.group_account_user"
        sequence="14"/>

</odoo>
