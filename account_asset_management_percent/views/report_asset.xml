<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

<template id="account_asset_management_percent.report_asset">
    <t t-call="report.html_container">
        <span t-if="type == 'simulated'">
            <t t-set="title" t-value="'Stampa registro cespiti SIMULATO ' + fy_name"/>
        </span>
        <span t-if="type != 'simulated'">
            <t t-set="title" t-value="'Stampa registro cespiti ' + fy_name"/>
        </span>
        <t t-call="l10n_it_account.internal_layout">
            <div class="page">
                <table style="width:100%; font-size: small;" cellspacing="0">
                    <thead>
                        <tr style="page-break-inside: avoid">
                            <th class="left_with_line">Rif.</th>
                            <th class="left_with_line">Descrizione</th>
                            <th class="left_with_line">Anno acquisizione</th>
                            <th class="left_with_line">Data acquisizione</th>
                            <th class="right_with_line">Costo storico di acquisto</th>
                            <th class="right_with_line">Rivalutazioni o svalutazioni</th>
                            <th class="right_with_line">Eliminazione / Vendita</th>
                            <th class="right_with_line">Fondo di amm.to fine esercizio precedente</th>
                            <th class="right_with_line">Coefficiente di ammortamento</th>
                            <th class="right_with_line">Quota annuale di ammortamento</th>
                            <th class="right_with_line">Fondo di amm.to fine esercizio in corso</th>
                            <th class="right_with_line">Residuo ammortizzabile</th>
                        </tr>
                    </thead>

                    <t t-set="counter" t-value="0"/>
                    <tbody>
                        <t t-set="ctgs" t-value="ctg_total(category_ids)"/>
                        <t t-foreach="ctgs" t-as="ctg">
                        <t t-if="ctg != 'total'">
                            <td><div t-esc="ctgs[ctg]['name']"/></td>
                            <t t-set="counter" t-value="counter + 1"/>
                            <t t-foreach="get_asset(data['ids'])" t-as="asset">
                                <t t-if="asset.category_id.id == ctg">
                                    <tr style="page-break-inside: avoid; border:1px solid #fff;" >
                                        <td class="left_with_line"><div style="page-break-inside: avoid" t-esc="asset.code"/></td>
                                        <td class="left_with_line"><div style="page-break-inside: avoid" t-esc="asset.name"/></td>
                                        <td class="left_with_line"><div style="page-break-inside: avoid" t-esc="asset_start_year(asset)"/></td>
                                        <td class="left_with_line"><div style="page-break-inside: avoid" t-esc="formatLang(asset.date_start, date=True)"/></td>
                                        <td class="right_with_line"><div style="page-break-inside: avoid" t-esc="formatLang(asset.purchase_value)"/></td>

                                        <td class="right_with_line"><div style="page-break-inside: avoid" t-esc="formatLang(asset_fy_increase_decrease_amount(asset))"/></td>
                                        <td class="right_with_line"><div style="page-break-inside: avoid" t-esc="formatLang(asset_remove_amount(asset))"/>
                                            <t t-if="asset.date_remove[:4] &lt;= fy_name if asset.date_remove else False">
                                                <div style="page-break-inside: avoid" t-esc="formatLang(asset.date_remove, date=True)"/>
                                            </t>
                                        </td>
                                        <td class="right_with_line"><div style="page-break-inside: avoid" t-esc="formatLang(asset_depreciation_amount(asset)[asset.id]['depreciated_value'])"/></td>
                                        <td class="right_with_line"><div style="page-break-inside: avoid" t-esc="formatLang(asset_depreciation_amount(asset)[asset.id]['factor'])"/></td>
                                        <td class="right_with_line"><div style="page-break-inside: avoid" t-esc="formatLang(asset_depreciation_amount(asset)[asset.id]['amount'])"/></td>

                                        <td class="right_with_line"><div style="page-break-inside: avoid" t-esc="formatLang(asset_depreciation_amount(asset)[asset.id]['depreciated_value'] + asset_depreciation_amount(asset)[asset.id]['amount'])"/></td>
                                        <td class="right_with_line"><div style="page-break-inside: avoid" t-esc="formatLang(asset_depreciation_amount(asset)[asset.id]['remaining_value'])"/></td>
                                    </tr>
                                    <tr>
                                        <td/>
                                        <td/>
                                        <td colspan="10">
                                            <t t-foreach="invoiced_asset_lines(asset)" t-as="invoiced_line">
                                            <t t-if="invoiced_line['supplier_invoice_number']">
                                                <div style="page-break-inside: avoid" t-esc="'Invoices n. ' + invoiced_line['supplier_invoice_number'] + ' - Date: ' + invoiced_line['invoice_date'] + ' - Supplier: ' + invoiced_line['partner_name']"/>
                                            </t>
                                            </t>
                                        </td>
                                    </tr>
                                </t>
                            </t>
                            <tr>
                                <td class="left_with_line"></td>
                                <td class="left_with_line"><strong>Totali <span t-esc="ctgs[ctg]['name']" /></strong></td>
                                <td class="left_with_line"></td>
                                <td class="left_with_line"></td>
                                <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['purchase_value'])"/></strong></td>
                                <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['increase_decrease_value'])"/></strong></td>
                                <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['remove_value'])"/></strong></td>
                                <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['value_depreciated'])"/></strong></td>
                                <td class="right_with_line"></td>
                                <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['value_depreciation'])"/></strong></td>
                                <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['value_depreciated'] + ctgs[ctg]['value_depreciation'])"/></strong></td>
                                <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['value_residual'])"/></strong></td>
                            </tr>
                        </t>
                        </t>
                        <t t-foreach="ctgs" t-as="ctg">
                            <t t-if="ctg == 'total'">
                                <tr>
                                    <td class="left_with_line"></td>
                                    <td class="left_with_line"><strong>Totale generale</strong></td>
                                    <td class="left_with_line"></td>
                                    <td class="left_with_line"></td>
                                    <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['purchase_value'])"/></strong></td>
                                    <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['increase_decrease_value'])"/></strong></td>
                                    <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['remove_value'])"/></strong></td>
                                    <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['value_depreciated'])"/></strong></td>
                                    <td class="right_with_line"></td>
                                    <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['value_depreciation'])"/></strong></td>
                                    <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['value_depreciated'] + ctgs[ctg]['value_depreciation'])"/></strong></td>
                                    <td class="right_with_line"><strong><span t-esc="formatLang(ctgs[ctg]['value_residual'])"/></strong></td>
                                </tr>
                            </t>
                        </t>
                    </tbody>
                </table>
                <br/>
            </div>
        </t>
    </t>
</template>
</data>
</openerp>
