<?xml version="1.0" encoding="utf-8"?>
<templates>
<!--  Icon is red when:
      1. qty requested is greater than qty available and product is not mto and date scheduled is greater than date requested
      2. product is mto and date scheduled is greater than date requested-->
    <div t-extend="sale_stock.qtyAtDate">
        <t t-jquery="t[t-if^='widget.data.virtual_available_at_date']" t-operation="attributes">
            <attribute name="t-if">widget.data.virtual_available_at_date &lt; widget.data.qty_to_deliver and widget.data.scheduled_date &gt; widget.data.commitment_date</attribute>
        </t>
    </div>
    <div t-extend="sale_stock.QtyDetailPopOver">
        <t t-jquery="table > tbody" t-operation="replace">
            <tbody>
                <t t-if="!data.is_mto">
                    <tr>
                        <td><strong>Forecasted Stock</strong><br />
                            <t t-if="data.virtual_available_at_date > 0">
                                <small>Stock available date<span t-esc="data.delivery_date"/></small>
                            </t>
                            <t t-else="data.virtual_available_at_date = 0">
                                <small>Stock unavailable</small>
                            </t>
                        </td>
                        <td><t t-esc='data.virtual_available_at_date'/>
                            <t t-esc='data.product_uom.data.display_name'/></td>
                    </tr>
                </t>
                <t t-else="">
<!--                    <tr>-->
<!--                        <td><strong>Expected Delivery</strong></td>-->
<!--                        <td class="oe-right"><span t-esc="data.delivery_date"/></td>-->
<!--                    </tr>-->
                    <tr>
                        <p>This product is replenished on demand.</p>
                    </tr>
                </t>
            </tbody>
        </t>
    </div>
</templates>
